<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Applicants Review</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css" rel="stylesheet">
  <link href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.bootstrap5.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-success mb-4">
  <div class="container-fluid px-5">
    <span class="navbar-brand fw-bold">Applicant Review Portal</span>
    <a href="/company/dashboard" class="btn btn-light btn-sm fw-bold">‚Üê Back to Dashboard</a>
  </div>
</nav>

<div class="container-fluid px-5 mb-5">
  <div class="card shadow border-0">
    <div class="card-header bg-white py-3">
      <h4 class="text-success mb-0">
        Candidates for <span th:text="${job.jobTitle}">Role</span>
      </h4>
    </div>
    <div class="card-body">

      <table id="applicantTable" class="table table-striped table-hover align-middle" style="width:100%">
        <thead class="table-dark">
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Contact</th>
          <th>Gender</th>
          <th>CGPA</th>
          <th>Branch</th>
          <th>Year</th>
          <th>Resume</th>
          <th>Status</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="app : ${applications}">
          <td class="fw-bold" th:text="${app.fullName}">Name</td>
          <td th:text="${app.email}">Email</td>
          <td th:text="${app.contactNumber}">Contact</td>
          <td th:text="${app.gender}">Gender</td>

          <td><span class="badge bg-warning text-dark" th:text="${app.cgpa}">8.0</span></td>

          <td th:text="${app.branch}">Branch</td>
          <td th:text="${app.yearOfPassing}">Year</td>

          <td>
            <a th:href="${app.resumeLink}" target="_blank" class="btn btn-sm btn-outline-primary">Open Link</a>
          </td>

          <td>
            <form action="/company/application/update-status" method="post">
              <input type="hidden" name="appId" th:value="${app.id}">
              <select name="newStatus" class="form-select form-select-sm fw-bold"
                      onchange="this.form.submit()"
                      th:classappend="${app.status == 'Hired' ? 'bg-success text-white' :
                                                            (app.status == 'Rejected' ? 'bg-danger text-white' : '')}">
                <option th:selected="${app.status == 'Applied'}" value="Applied">Applied</option>
                <option th:selected="${app.status == 'Shortlisted'}" value="Shortlisted">Shortlisted</option>
                <option th:selected="${app.status == 'Hired'}" value="Hired">HIRED</option>
                <option th:selected="${app.status == 'Rejected'}" value="Rejected">Rejected</option>
              </select>
            </form>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.bootstrap5.min.js"></script>

<script>
  $(document).ready(function() {
      $('#applicantTable').DataTable({
          dom: 'Bfrtip',
          buttons: [ 'copy', 'excel', 'print' ],
          "pageLength": 10
      });
  });
</script>
</body>
</html>